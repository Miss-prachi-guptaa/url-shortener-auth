<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>URL Shortener</title>

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/style.css">

  <!-- Material Design Iconic Font (ZMDI) -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/material-design-iconic-font@2.2.0/dist/css/material-design-iconic-font.min.css">
</head>

<body>
  <!-- Header -->
  <%- include("./partials/header.ejs") %>

    <!-- Login Status -->
    <div class="status-msg">
      <% if (user) { %>
        <p class="login-status success">‚úÖ You are logged in</p>
        <% } else { %>
          <p class="login-status danger">‚ö†Ô∏è You are not logged in</p>
          <% } %>
    </div>

    <!-- Main Container -->
    <div class="container">
      <h1 class="main-title">üîó URL Shortener</h1>

      <!-- URL Form -->
      <form action="/" method="post" class="url-form">
        <div class="form-group">
          <label for="url">Enter URL:</label>
          <input type="url" name="url" id="url" placeholder="https://example.com" required>
        </div>

        <div class="form-group">
          <label for="shortcode">Enter Shortcode (optional):</label>
          <input type="text" name="shortcode" id="shortcode" placeholder="my-link">
        </div>

        <!-- Flash Errors -->
        <% if (errors && errors.length> 0) { %>
          <div class="flash-error">
            <ul>
              <% errors.forEach(function(error) { %>
                <li>
                  <%= error %>
                </li>
                <% }) %>
            </ul>
          </div>
          <% } %>

            <button type="submit" class="btn primary">Shorten</button>
      </form>

      <!-- Shortened URL List -->
      <div class="url-list">
        <h2>üìÉ Shortened URLs</h2>
        <ul>
          <% if (links.length> 0) { %>
            <% links.forEach(link=> { %>
              <li class="shortlink-item">
                <div class="shortlink-left">
                  <a href="/<%= link.shortCode %>" target="_blank" class="short-url">
                    <%= host %>/<%= link.shortCode %>
                  </a>
                  <span class="original-url"> - <%= link.url %></span>
                </div>
                <div class="shortlink-buttons">
                  <button class="copy-btn" data-url="<%= host %>/<%= link.shortCode %>">
                    <i class="zmdi zmdi-copy"></i>
                  </button>
                  <a href="/edit/<%= link.id %>" class="edit-btn">
                    <i class="zmdi zmdi-edit"></i>
                  </a>
                </div>
              </li>
              <% }) %>
                <% } else { %>
                  <li class="no-urls">No URLs yet.</li>
                  <% } %>
        </ul>
      </div>
    </div>

    <!-- Footer -->
    <%- include("./partials/footer.ejs") %>
</body>

</html>